<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ken Morgan Real Estate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            color: #fff;
            overflow: hidden;
        }
        
        .video-background {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            z-index: -1;
            overflow: hidden;
            background: #000;
        }

        .video-background video {
            min-width: 100%; 
            min-height: 100%;
            width: auto;
            height: auto;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 0;
        }

        .content-over-video {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow-y: auto; /* Allows content to scroll on small screens */
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }

        .content-over-video::-webkit-scrollbar {
            display: none; /* Chrome, Safari, and Opera */
        }
        
        .content-over-video h1 {
            font-size: 3rem;
            margin: 0.5rem 0;
        }
        
        .content-over-video p {
            font-size: 1.25rem;
            max-width: 800px;
        }

        .form-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            max-width: 600px;
            width: 100%;
        }

        .form-section {
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-section h2 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
            text-align: left;
        }

        .input-group label {
            font-weight: bold;
        }

        .form-section input[type="text"],
        .form-section textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            border: none;
            border-radius: 0.5rem;
            background-color: rgba(255, 255, 255, 0.2);
            color: #fff;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .form-section input[type="text"]:focus,
        .form-section textarea:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.3);
            border: 1px solid #007BFF;
        }

        .form-section input[type="text"]::placeholder,
        .form-section textarea::placeholder {
            color: #ddd;
        }

        .button {
            background-color: #007BFF;
            color: #fff;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            font-weight: bold;
        }

        .button:hover {
            background-color: #0056b3;
            transform: scale(1.02);
        }

        .llm-output-container {
            margin-top: 1.5rem;
            text-align: left;
            min-height: 100px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 1rem;
            font-style: italic;
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007BFF;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <div class="video-background">
        <!-- This video will autoplay, loop, and be muted -->
        <video autoplay loop muted playsinline>
            <source src="https://raw.githubusercontent.com/Lethalfirestorm/Lethalfirestorm.github.io/main/Animate_this_and_202509051207.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <div class="video-overlay"></div>
    </div>

    <div class="content-over-video">
        <div class="form-container">
            <div class="form-section">
                <h1>Unlock Your Home's Potential</h1>
                <p>Curious about the value of your property? Get started with a free home evaluation and connect with our expert team.</p>
                <form class="email-form" action="mailto:sales@Kenmorgan.CA?subject=Start my free home evaluation!" method="POST">
                    <button type="submit" class="button">Start My Free Evaluation</button>
                </form>
            </div>

            <!-- New section for the Gemini API feature -->
            <div class="form-section">
                <h2>Generate a Property Description</h2>
                <p>Enter your home's details and let our AI craft a professional listing description for you.</p>

                <div class="input-group">
                    <label for="bedrooms">Bedrooms</label>
                    <input type="text" id="bedrooms" placeholder="e.g., 4">
                </div>

                <div class="input-group">
                    <label for="bathrooms">Bathrooms</label>
                    <input type="text" id="bathrooms" placeholder="e.g., 2.5">
                </div>

                <div class="input-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" placeholder="e.g., Hamilton, Ontario">
                </div>

                <div class="input-group">
                    <label for="features">Unique Features</label>
                    <textarea id="features" rows="4" placeholder="e.g., Gourmet kitchen, large backyard, finished basement"></textarea>
                </div>

                <button id="generateBtn" class="button">✨ Get Property Description ✨</button>

                <div id="llmOutput" class="llm-output-container">
                    <p>Your AI-generated description will appear here.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const generateBtn = document.getElementById('generateBtn');
        const bedroomsInput = document.getElementById('bedrooms');
        const bathroomsInput = document.getElementById('bathrooms');
        const locationInput = document.getElementById('location');
        const featuresInput = document.getElementById('features');
        const llmOutputDiv = document.getElementById('llmOutput');
        
        // This is a placeholder for the API key, which is handled automatically by the environment.
        const apiKey = "";
        const apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=" + apiKey;

        const generateDescription = async () => {
            const bedrooms = bedroomsInput.value;
            const bathrooms = bathroomsInput.value;
            const location = locationInput.value;
            const features = featuresInput.value;
            
            // Show a loading state
            llmOutputDiv.innerHTML = '<div class="loader"></div>';
            
            // Construct the system instruction and user query
            const systemPrompt = "You are a professional real estate copywriter. Your task is to write a concise, compelling, and descriptive summary of a home for a property listing. The summary should be one paragraph and highlight the key features provided by the user. Use engaging language to attract potential buyers. Do not use bullet points or lists. The tone should be professional and inviting.";
            const userQuery = `Write a property description for a home with ${bedrooms} bedrooms, ${bathrooms} bathrooms, located in ${location}. The unique features are: ${features}.`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            let retryCount = 0;
            const maxRetries = 3;
            const delay = (ms) => new Promise(res => setTimeout(res, ms));

            while (retryCount < maxRetries) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429) { // Too Many Requests
                            retryCount++;
                            await delay(Math.pow(2, retryCount) * 1000); // Exponential backoff
                            continue;
                        } else {
                            throw new Error(`API error: ${response.statusText}`);
                        }
                    }

                    const result = await response.json();
                    const text = result?.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (text) {
                        llmOutputDiv.innerHTML = `<p>${text}</p>`;
                    } else {
                        llmOutputDiv.innerHTML = `<p>Error: Could not generate a description. Please try again.</p>`;
                    }
                    return; // Exit the loop on success
                } catch (error) {
                    llmOutputDiv.innerHTML = `<p>An error occurred: ${error.message}</p>`;
                    return; // Exit the loop on error
                }
            }
            llmOutputDiv.innerHTML = `<p>Failed to get a response after multiple retries. Please try again later.</p>`;
        };

        generateBtn.addEventListener('click', generateDescription);
    </script>

</body>
</html>
